#include <math.h>
#include <stdio.h>
#include <stdlib.h>
#include <time.h>

#include "rsa.h"

#ifdef HAVE_MEMWATCH_H
#include <memwatch.h>
#endif

#define N               16
#define noErr            0
#define DATAERROR       -1
#define KEYBYTES         8

//ORGINAL:
//unsigned int P[N + 2] = {
//  0x9d92817a, 0x56fda3c2, 0x38761cdc, 0x6d2d7e14, 0xe5764b4c, 0xd1777214, 0x939abd4c, 0xdad2184d, 0xb59dd049,
//  0x98aa795b, 0x2dd49c80, 0x0a764944, 0xb2a7ac44, 0x14aa6d10, 0x3b6b591e, 0xcd452df4, 0x5d93260c, 0xb52a523f
//};
//
//unsigned int S[4][256] = {
//  {
//    0x4cd956b4, 0x09cc3c65, 0xe469401c, 0x6615301c, 0x9ff60c5c, 0x93590fb4, 0x9055a60e, 0xe07e6704,
//    0x457ed66a, 0x86706c29, 0xb910701c, 0x894dcdd4, 0xc11bd888, 0x6d33638e, 0x069e73d4, 0xcfaff3a4,
//    0x418150f4, 0xf1f90d4d, 0xf8f353e9, 0xd7c7bbac, 0x96a9da50, 0x1eb6ba43, 0xbe38c268, 0x0ae03de5,
//    0xf37a6add, 0xbb7b7573, 0xacd738b2, 0x0d4411be, 0x769ebe4b, 0x4d7edfb1, 0x8eaf87d2, 0x69d07971,
//    0x24b62fc9, 0x622d8362, 0x21d27a49, 0xe3b80649, 0xae53387a, 0xd3e99ff9, 0x7f5b1598, 0x44ceb51c,
//    0x703b7035, 0xe083acb7, 0x37488548, 0x44de1d86, 0xe6f71fb0, 0x630de2e9, 0x4c22f924, 0xa77438f0,
//    0x5e2e886e, 0xffb2a904, 0x91145e46, 0x06566142, 0x80ae54b0, 0xe6b45884, 0xc86e91bf, 0x3ac9bc39,
//    0x193daa39, 0x2d879b71, 0x70d47ec0, 0x2fec50d3, 0x125338d6, 0xe8cce506, 0x3f11a84b, 0x0ecd3b0e,
//    0x8c42d7b9, 0x822fa454, 0x1bb9c32d, 0xc4042642, 0xf25dadcd, 0x19d315c6, 0xcd4f504a, 0x56746a95,
//    0xd3e379fd, 0x87af4fcf, 0xfbd070b0, 0xd9056b6b, 0x6f34df4a, 0x42d17e4d, 0x2390f49f, 0x7a0d5cda,
//    0x5dedc81b, 0x884f35c3, 0x77fe0958, 0x88d56b5e, 0x909862df, 0x6d39fe15, 0xce400f9a, 0xc052bb63,
//    0x8bab34e6, 0xf8af0962, 0xeab87265, 0xd71569a1, 0x9bcf7bf6, 0x7dedc5cb, 0x8446eaa2, 0x750b514e,
//    0xbfac4607, 0x5ed08e0d, 0x21c9dab7, 0x075c4e9d, 0x916752b0, 0xf62bdc35, 0x2fe0dc9c, 0xeceb1e0a,
//    0x8a774190, 0x4f6f9085, 0x23917e00, 0xccec20f4, 0x692c51f4, 0x74f424cf, 0x65807a0d, 0x4027555a,
//    0x01fa807e, 0x4a7bc605, 0x1286703e, 0x49076202, 0x45710589, 0x1868950e, 0x003db166, 0x184b871f,
//    0xc9f6548e, 0x81f786f2, 0x6194bdf4, 0xbd6539c2, 0x9b5e055c, 0xd435ccae, 0x18581786, 0x9c8eb963,
//    0x43773dc4, 0x28dd09f6, 0x97a979b3, 0x85298502, 0x9facc8a3, 0x25b4e939, 0xd8415a36, 0xc14c44b8,
//    0x1e72b482, 0x720237ce, 0x2a279cf8, 0xd303c87a, 0xdd175dbc, 0x6806cc08, 0x1bb61b4b, 0x3bd22524,
//    0x5b37dccf, 0x1ea805e6, 0x465f8c37, 0x196a8927, 0x2ffd006d, 0x63ab43fe, 0x0db50852, 0xc729851a,
//    0x3fd82ca7, 0x629ca19b, 0x659ee92a, 0x62d2d4f0, 0x605ba295, 0x3b505d2b, 0x99ac346f, 0xf5418a3a,
//    0x615d3e5c, 0x9cbb256b, 0x28ebda4d, 0x94cf0049, 0x29eab9cf, 0xa3f8397f, 0x92529160, 0xb8e6d18c,
//    0x531382d5, 0x1c6ecd40, 0x95cb68af, 0x6c6dbfd6, 0xc267cdfe, 0x192f8463, 0x8aca24fd, 0x9fd561d6,
//    0x235828b9, 0xfb801299, 0x3cc0cbd2, 0xeed359fa, 0x62c892b1, 0x8e316596, 0x933aaf00, 0xcf481ff6,
//    0xe868d4b1, 0x55e66155, 0xc1706f05, 0x44576ed8, 0x54e1699b, 0x73a28fef, 0xe5d4826b, 0x79ad3313,
//    0xe838ff2e, 0xbd3edac4, 0xd963824d, 0x5b81dece, 0x2d52f4a0, 0x5c276795, 0x70482a64, 0x5d8054db,
//    0x6c040ae0, 0x064daad0, 0x9badf37e, 0x0d43ddbd, 0x1581dbf8, 0x73266f4e, 0xa9b2231d, 0xc1731e6c,
//    0xba377032, 0x673dd7ff, 0x97192c6a, 0x8c0b7756, 0x54b180ae, 0x1c31540e, 0x92ed959f, 0x3b7ba7dc,
//    0xf3d4bcca, 0x0cb7d041, 0x02ce2e9f, 0x1e2544ce, 0xb679a710, 0x4e1d7bd4, 0x8522044d, 0xaef4e284,
//    0xf65bd239, 0xe131cc16, 0xf654a618, 0x03551ad5, 0x7dac44a6, 0x009a0ac7, 0x51c3fc7e, 0x5b59f0fa,
//    0x4fff53a1, 0xc553e9d8, 0x274b9ff2, 0x8a28deee, 0x01d05b10, 0xdd98bb92, 0x93c5ccc4, 0x28211408,
//    0xa17b9525, 0x663dd4b3, 0xe850501b, 0x8e8c18e0, 0xc893c383, 0x221f99ef, 0x44aeb043, 0xacfc696c,
//    0x40a755e4, 0xafd25279, 0x230f3ea8, 0x04ff9c4d, 0x28603278, 0xc8f1e373, 0x032a7f1d, 0x3c252c89
//  },
//{
//  0x6ee5ef5b, 0xea4433f2, 0xc0210fe4, 0xb23aaab7, 0xb5b8a510, 0x641ba77a, 0x0662d0b3, 0x1bbcba0c,
//  0x8d0fd621, 0x06fef417, 0x1f0cef3a, 0xf01e54c8, 0xfe18e408, 0xa915779f, 0x38ad4e7b, 0xb9b77c03,
//  0x90b6138e, 0x0e4d1893, 0x58d8f8e7, 0xf57bb8aa, 0x60b2dd55, 0x8ada1c93, 0xf2eaf056, 0x99e6b42e,
//  0x359bfd79, 0x2a5eaa21, 0x209f4247, 0x63011edc, 0xd8e9a95b, 0x46b0ba93, 0xfc3835b1, 0x64f5ddce,
//  0xf6388a61, 0xede2f3f0, 0x96701a0b, 0x7be78c6e, 0x8cd7dd46, 0xf9b53b8f, 0xd11dba7f, 0x4b445e40,
//  0x167cc238, 0x50d579e9, 0xd730f3ce, 0xe36627db, 0xa717e346, 0xb20185a1, 0x79755708, 0x402dbbbf,
//  0x4995c430, 0xb7ee1060, 0x98eabd74, 0x837b89e9, 0xdd3b994b, 0xa84feb91, 0x988898bc, 0x0f91a9bb,
//  0xc2fb4cb5, 0x2928c535, 0x44742aa1, 0xe8e066e5, 0xd25eb1a4, 0x280fee81, 0x314c995d, 0x692e6243,
//  0x6831966c, 0x949b68bb, 0xa5ee56a6, 0xb1030b49, 0x05194fe9, 0x3d6a5521, 0xec764165, 0xdad961f3,
//  0xa2e9d438, 0x9f4d3b28, 0x340f4a7a, 0xbae96e64, 0x8d81aee0, 0x737807c6, 0xb25ba717, 0xb41e13e3,
//  0x6194900c, 0xc82df5d8, 0x15b5b860, 0x9c61cdc3, 0x2e9c6592, 0x72cf98db, 0x137baca2, 0xbf792d77,
//  0xf2ae5ed2, 0x8aed8aa8, 0x06a08630, 0x07242e53, 0xc4ee5cb4, 0x6327a4a8, 0x262da25a, 0x8c0d3b11,
//  0xaca20ecc, 0x7670da28, 0xfb2f9488, 0xce40223c, 0xe28e9023, 0xcd01197f, 0x5a38cb33, 0x1d58dfb1,
//  0x3582a409, 0x9ccbd2f7, 0xb213db4a, 0xa0518455, 0xc50d013c, 0xa4a89a0b, 0xfaa4fcd1, 0x32f31c6d,
//  0x1ca02b05, 0x73df3b8b, 0x87e96f1b, 0x5ac3e476, 0xec8ba258, 0x2c56422a, 0xfa0c9fc4, 0xbbafb856,
//  0x745753fb, 0x7ce494a2, 0x1dccc371, 0x4c9ccb35, 0x2938982d, 0xa795c80c, 0x586f8456, 0x5d17a593,
//  0x07a45f1c, 0x3a60ff3e, 0xa540a4d5, 0xce3bb982, 0xacbef9c5, 0x36341a7d, 0xda25d205, 0x221fd0ad,
//  0x3d423dde, 0xae902f74, 0x19378d0c, 0x9da1ce23, 0x56b112a7, 0xf752105e, 0x5bd693f3, 0xb682921e,
//  0xd54b231d, 0x4c8a2ea4, 0xb8b9f4df, 0x64b36593, 0x7a6c780c, 0xf2148361, 0xdfadaa15, 0xcd193f05,
//  0x72692cdb, 0x86772869, 0x78a24d80, 0x7d7df886, 0x4dc09761, 0x2bf59781, 0xcd34257f, 0xa054fad0,
//  0x28e7c8ab, 0x56369d2d, 0x188f16ea, 0x6a8e7dc4, 0x2f2da909, 0xd4c354fc, 0xefbfbcc6, 0x882d66b4,
//  0x0df37abe, 0x3b9e4310, 0x3f87bbb3, 0xb2bc8e12, 0x8e1dd2be, 0xbc03a485, 0x0329352b, 0xfae6e5bd,
//  0xd287b4a7, 0xd8182712, 0x49505831, 0x8169d03c, 0xb6f374d3, 0x0b97af79, 0xe84a258d, 0xd078c2d4,
//  0x568d9b54, 0x46df04d1, 0xb652176a, 0xd7c0579f, 0x926f4fac, 0xf7e8c085, 0xf89e50a2, 0x8b60cab4,
//  0x5fa43f87, 0x0cb74c28, 0x59c59d56, 0xa2615a38, 0x054184b0, 0x1dd07f07, 0xade2a93d, 0x783ceff0,
//  0xa53bc973, 0xffd3125e, 0xbb9cf03b, 0x4e245c78, 0x3e23c51f, 0x61a76488, 0x8d82d8c0, 0x3faf8f1c,
//  0xcf2f447e, 0x75de4c2d, 0xfb7f6838, 0x92601a04, 0x8e878c47, 0x317bfb81, 0x7383c493, 0x354b6bf0,
//  0x2e1c94aa, 0x5a92b2f1, 0x9a178265, 0x2995178a, 0x955563f6, 0x10b7f8bb, 0xeb2506d2, 0xf387914a,
//  0x06aad975, 0x08f21717, 0xf139d563, 0x399d4554, 0x1ca8ee0e, 0xffda0f29, 0x53e86f28, 0xe1cee73d,
//  0xf05c6ac4, 0xb598626f, 0x67425c35, 0xacec4af3, 0x7e7ada9b, 0xf3791731, 0xefb78052, 0xfd8bac82,
//  0xd48e251c, 0xdb745181, 0x227058e7, 0xde87e83e, 0xa936d059, 0xd989fe07, 0x35b9a407, 0x0ac5a3be,
//  0xe8f21fba, 0x99e2739c, 0xf19ad4fc, 0x0553ee90, 0x6f8b66aa, 0xd1945dc5, 0x4d5aa02a, 0xd223bc78
//},
//{
//  0xfb21629a, 0xc740a6ac, 0xbb66d4b3, 0xbe7fcb4b, 0x8992b590, 0xe7276d3a, 0x7411d85a, 0xdd18b161,
//  0xc1617f22, 0xb754e9fa, 0x0c879dd4, 0x50a7ba27, 0x5e0bc188, 0xc4e07142, 0xf6f1d001, 0x824e827a,
//  0x022149e0, 0x2301b5ce, 0x016f4e46, 0x11453307, 0x2b57267e, 0xd99ac91c, 0x686bbb07, 0x511a6def,
//  0x3490025a, 0xd7381de7, 0x9d1c2163, 0xc3ff9d20, 0xee87ecdf, 0xc6f3b85a, 0xb448d37c, 0x20d30abe,
//  0xa37b06b6, 0xef057b64, 0xd7516303, 0xd9edb7d4, 0x19c993d1, 0x8ce0db06, 0x94d248ed, 0x46afb071,
//  0x81197412, 0xdf5e2d2a, 0xe1cb6e01, 0xbec5e95e, 0xee443100, 0xe491be9c, 0x80cb16ed, 0x10ef3a40,
//  0xcd69fc48, 0x102d89ce, 0x2078fd1c, 0x65a4917c, 0xed979221, 0x858bf11a, 0xe32e2661, 0xe0953efe,
//  0x7bf90091, 0xa184a9e7, 0xbfc2b0d9, 0x823a66cc, 0x8951dcdb, 0x664d843f, 0x5b6387a5, 0xf7101dc4,
//  0x49fc2ab9, 0x1f90e9d6, 0x7de78da5, 0x31ad5bcd, 0x331dbe76, 0x90be440f, 0xf2ed0a10, 0xa992af3f,
//  0x73aff422, 0xc2e6583c, 0x41fbd562, 0xe8a9b6f8, 0x4f3c4f29, 0x8aa4e083, 0x42d98d47, 0x9ae0cd3c,
//  0xd2966734, 0x5bd833e4, 0x3787dfbd, 0x6a23ac6d, 0x39496186, 0x24881bae, 0xbcdb8c4f, 0xcf031f41,
//  0xe05c258a, 0x00808ebe, 0xae096f5e, 0xa1ccb8e3, 0xfce10cba, 0xf2ac54d6, 0xe532c1a5, 0x22dd04f1,
//  0x7120f187, 0x4960fde7, 0xf6060a89, 0xa73cde64, 0xedc7d26b, 0x4e5ff111, 0x59206e80, 0x958b57c8,
//  0x9db302bb, 0xcfd4ae93, 0x27f7ee92, 0x9212a260, 0xb0232821, 0xd1f74418, 0x40a9a28d, 0xe4081533,
//  0xe80bc57d, 0xf557b997, 0x64856fd8, 0x5df445ff, 0xe26392d3, 0x7c787838, 0xf9ff8264, 0xfa19934e,
//  0xd53f2767, 0x65705113, 0x69aa522b, 0x1be549a4, 0xfb60bd3f, 0xed7fbc02, 0xb901a8eb, 0x2096b5dd,
//  0x82eef506, 0xe14d7f25, 0x1fc410c5, 0xe78e63c9, 0xf97afdd3, 0x05c8bf4c, 0x732ac31a, 0xe71d4106,
//  0x075c1a2d, 0x9c7ae240, 0x550e1d9d, 0x53821593, 0x57fc166b, 0x4eaea669, 0x83c8fe43, 0xdee7839d,
//  0x9a68622d, 0xb1d20dbd, 0x872505d8, 0x99f7913e, 0x805c9e71, 0x75ed89b1, 0x99489c9c, 0xb78091a4,
//  0x4cce93aa, 0x4bd065af, 0xf2cfb18c, 0xa9baf15a, 0x10377c5a, 0xbd7ba928, 0xf9705785, 0x19b733be,
//  0x020decce, 0x724a60e2, 0x1636f104, 0x8075975c, 0x0819a499, 0x5673d10e, 0x5c90d3b9, 0x39248877,
//  0x975086ad, 0x8f648dd9, 0x403b8f2e, 0x26a5c108, 0xe617ff78, 0x4299e545, 0x59622446, 0x5fcea27b,
//  0xc381b8c5, 0xc8a59274, 0xd1ce52e6, 0x87b42f4c, 0x7273f49f, 0xb185b6f4, 0x373e8324, 0xe9d476a6,
//  0xdfd48046, 0xac90500e, 0x53c2f97c, 0x1b95683f, 0xd5c490b0, 0xbfaae001, 0x46f86f6d, 0xd23d6cbc,
//  0x9d7dc08c, 0xef8dea30, 0x1d5d4e14, 0x52c6b311, 0x8af1acad, 0x7ed920cc, 0x386882c4, 0x5bd2e6be,
//  0xa3c1b46c, 0x51376b1a, 0xadde205a, 0xecf29440, 0x9dd2e47d, 0x49aaa930, 0xa5b24572, 0x11f66764,
//  0x3d64baaa, 0xad40eacc, 0xee133aa6, 0xd5982377, 0x4c16580a, 0x79f58710, 0xe9a2c65c, 0x570a04a2,
//  0x765f7806, 0x37170c99, 0xb1be17af, 0xae829684, 0x89aa85d8, 0x6d522518, 0x12ea40c6, 0x1e5c8784,
//  0x56d6146d, 0x2c69ba02, 0x20493221, 0x9e052e83, 0x958f38a7, 0x93424633, 0x61526826, 0xacd5905e,
//  0xd8ffb839, 0x1076ea7a, 0x1dd30960, 0xe04437d9, 0xe96b7547, 0x66e73108, 0x4241ffad, 0x0fc19efc,
//  0x15c8cc2a, 0xc4e87398, 0xa91735da, 0x475c1752, 0x3d2aef13, 0x873a56aa, 0x8667bf1e, 0xe18b533e,
//  0x37be8a46, 0x7ff843cc, 0xf0fbcde8, 0xff6cf617, 0x7f0a166b, 0x4fe82f57, 0x7cc86233, 0x21199e3b,
//},
//{
//  0x9f1c07c9, 0xf070d1d7, 0xbcbbc8b8, 0x693d073e, 0xb5070ff6, 0xbd860452, 0xdd02d81f, 0x04d6970c,
//  0x2af6fb2f, 0xc6d73f9a, 0x37f401f5, 0x2c66f92b, 0x66b5a91d, 0x610c82e8, 0xb5b1f900, 0x7e16e3ab,
//  0xe8fc4b45, 0x14a55baa, 0x130932cd, 0x97580abc, 0x77b868c1, 0xcbbe3c60, 0xa95d5195, 0x696d62ed,
//  0x30878338, 0x79cd3c7c, 0xf9ed9bb8, 0x7c389e5a, 0x23fc70f2, 0xc13b31b0, 0xe9402978, 0xeb2141fe,
//  0x034c76a4, 0x1897236a, 0x8c92ea8e, 0xb89bdf84, 0x55851440, 0xf261ec8f, 0x5d8538a0, 0xf462fb01,
//  0x32487ad6, 0x0408e477, 0xdc785810, 0xddee53cd, 0xe20042f4, 0xe93bc26c, 0x8449a28f, 0x9db0a530,
//  0x12735bbe, 0x24db94d6, 0x7e5f5eb0, 0xda8087cc, 0x79a6c526, 0x2f1100a7, 0x5aeb3d74, 0x9edf776f,
//  0x50a359db, 0xc55f6e5e, 0xcc6c3416, 0x86876ba8, 0x0decf580, 0x592ee1a2, 0x0a8a0087, 0x2f6ec4c3,
//  0x7132eff1, 0x9ebb9a8f, 0xcaa36d01, 0xbf729d96, 0x5b897de7, 0x7f604454, 0xe5159c2f, 0x8cb47c21,
//  0x4aee5d1d, 0xacb8a43b, 0x158eef37, 0x21293444, 0x407d96f2, 0xeaed46cc, 0x6e119a72, 0x8ad01c5d,
//  0xf74d92a4, 0x0be204f4, 0x9d9d6de7, 0x2f98d4ff, 0xb7b84693, 0x050e4804, 0x88785f71, 0x85e671ef,
//  0xe748a51e, 0x0787ecff, 0x52be754d, 0xe16960b9, 0x69e4f5cc, 0x3d608f3c, 0x2cd02b13, 0xf5668254,
//  0x6e7aef4e, 0xe81fda5d, 0xdc6c0557, 0xe8d97bf5, 0xd925a355, 0x659d66b5, 0xcb133740, 0xf1ac0fb1,
//  0xe2f30995, 0x98053f1f, 0xb7e532a5, 0x47397942, 0x24db9d1e, 0xc1a4216c, 0x3f445ecb, 0x08d7b6d8,
//  0x74b3f4b9, 0x8c95beb8, 0xd5128f17, 0x9486ef59, 0x73fc7273, 0xec3022ce, 0xb042194b, 0x7d28eb4b,
//  0x964d3e4c, 0xac04f15c, 0x13906ac4, 0x0c2b1b18, 0x079906cf, 0x9f33d504, 0x15605f35, 0x4fe21441,
//  0x070eb088, 0xba609b02, 0xfc2907cc, 0xa079d925, 0x2e9b8313, 0x5bbd9612, 0x838a55d1, 0x966a3f7d,
//  0x60c9ad7b, 0x9ae1f9da, 0x4f975de2, 0x4a8a7620, 0x4fd9a679, 0x382a7da8, 0x689bf663, 0x9d7ed53f,
//  0xd9670d57, 0xdabaf6a1, 0x12f34ebf, 0xb362feb3, 0xef312f7a, 0x91feefb5, 0x5552a5e3, 0xfcb4093a,
//  0x3f975bea, 0xfd987e38, 0xd2c01240, 0x6f6fb48e, 0x81f6b63d, 0x904c4bfc, 0x0685307d, 0x26bce6d3,
//  0x03bbc84b, 0x4fc558ad, 0x0edd14b6, 0x647d0bfc, 0x314ab7ad, 0x9e1bad92, 0xb1cf3830, 0x104a42ac,
//  0x2e9bc5bf, 0x4d1a5f55, 0xcdd997c3, 0x2c1665bd, 0xda1751f2, 0xc0183b80, 0x76e697ce, 0x28279718,
//  0x832f92ce, 0xb377105a, 0xd1d77d2a, 0xb82d1c3e, 0xc209257e, 0x58e9b9a3, 0xf09af92f, 0x138c0ebd,
//  0xcbe0d244, 0xc3ffe318, 0x55006a1d, 0x1ae8624a, 0x8b1645c8, 0x264fc11f, 0xee7c4987, 0x5c695b83,
//  0x37126f03, 0x043e5dca, 0x1b11afef, 0xbd1f7671, 0xdcabf38a, 0x2fc05e1a, 0xcf526bfa, 0x9d3b2d43,
//  0x079d4247, 0x9d4687fc, 0x9639746d, 0x0c7dd1bc, 0x7b1d435c, 0x213f50a9, 0xe40d32b4, 0x5d9c4e1f,
//  0x639ef1b5, 0x7196643e, 0x9ba6b036, 0x1c507716, 0xe5f03294, 0x1ca539ec, 0x7ce74d87, 0xdd061097,
//  0x048fb4ad, 0x83b35e49, 0x3a7969b3, 0x2c0b44a7, 0xb8ba96fc, 0x0c80ca8f, 0x44a021b1, 0xf17def3a,
//  0xc090d45a, 0xca030e07, 0x2abe83fb, 0xd7347fe5, 0xa7f0b6fa, 0x52e2864b, 0xc56f25e8, 0x1c086d3d,
//  0x5334178b, 0x18d91045, 0x0b8b7546, 0xaa3ee034, 0xe0a04f1e, 0xf9843b3a, 0x4291ffc7, 0x70fd3010,
//  0x8e45c8a8, 0xb6af4330, 0x1e15cc99, 0x07cec271, 0x002a8eba, 0x09d62d62, 0xecdec146, 0x65285321,
//  0xb35b2d7b, 0xddfc7afc, 0x78cabaa3, 0x8613f731, 0x497eebe7, 0xdff9a445, 0x69a1e815, 0xf432f998,
//}
//};


unsigned int P[N + 2] = {
  0x3197e790, 0x77fe8563, 0xc303859d, 0x47f341bd, 0x3ea838c5, 0x2324172e, 0xd15a3c51, 0xb95a3934, 0x02b32d7c,
  0x618ceb27, 0x9766134e, 0x94d4d694, 0x14386c46, 0x4fbe4fa7, 0xde444051, 0xbb09dc89, 0xb897e575, 0xa2f11bd8
};

unsigned int S[4][256] ={
  {
  0xfe9d6f09, 0x5b818be9, 0x0c61df36, 0x4ebe3aad, 0x6aa88e88, 0x43f47743, 0x9197eb14, 0x3c741b6b,
  0xa865cea6, 0x22773266, 0x102daef2, 0x6a81b9e9, 0x47301fff, 0xe5391a70, 0x2eb47913, 0x045b7fa7,
  0x6b2ec326, 0x1c570ce9, 0x1a754621, 0x54ccab03, 0x9725c112, 0x50633423, 0x11b375a8, 0x75feb24f,
  0x2c53a0cd, 0x31d76780, 0xa783e8bf, 0x4a8103f0, 0x5651862b, 0x0551785d, 0xf993d1d3, 0x888f601e,
  0xaac9e8cf, 0x388a13c2, 0x11c6d678, 0x7f6b28c3, 0x2d044943, 0x220f424d, 0x89e198f8, 0xed8a2fbc,
  0xb4ce8d16, 0x98c2b7ae, 0xc2c54d90, 0xb42f4abc, 0x013de501, 0x66847f76, 0x15db9420, 0x4b86b14b,
  0x3d3e8748, 0x2e090734, 0xb639a415, 0xc1964cd2, 0x12be83af, 0xd92301a8, 0x72b0ae14, 0xa3827a09,
  0xa84266d6, 0x3e237b44, 0x4b38d552, 0xa2557dbc, 0xd7e2310e, 0x5571f40c, 0xed80774f, 0xaee508b8,
  0xd21d457f, 0xcce72705, 0x5285d06c, 0xda307827, 0x76bc3ec0, 0xcfc58f9e, 0x6819e325, 0xd8d0233b,
  0xdd956bfe, 0x6adb4a7a, 0x02897f89, 0x24328777, 0x13f5adb0, 0x8e8acb45, 0x6ce7381e, 0xe6f464b0,
  0x36655db3, 0x23bd5c81, 0xee7efe50, 0xc0893d8e, 0x222f17b2, 0x1711dd8c, 0x9988435d, 0xa0c0b4a1,
  0xb893b7b3, 0x4c14be38, 0xf7807e88, 0xc02e3442, 0x0e6749e5, 0xe8cb2176, 0x127ee6e5, 0xe1762184,
  0x96562e49, 0x01bee085, 0x5cbe7919, 0x83de53de, 0x23a9a0c1, 0x1e75a219, 0x75276d3a, 0x2653d854,
  0xab005017, 0x8b80c2f5, 0x867cd864, 0xc487b2af, 0xa7c46a58, 0x3b026f6f, 0x3b2fa4be, 0x2d3671b5,
  0xe24a3033, 0x81a294e7, 0x7de0a0f3, 0x53d28c28, 0x18dbfa7f, 0x911a66c8, 0xbaffa44a, 0xc937a9d3,
  0xee602440, 0xc00a51fd, 0x10ab1fe8, 0x13879467, 0x10d4a2f1, 0x190999f2, 0x43575faf, 0x3fae9088,
  0x179ee32b, 0xc14f4447, 0x0c75eab1, 0xa1543688, 0xeadebed9, 0x2ae6ba88, 0x86c80080, 0x4d832b36,
  0x69f849c6, 0x8c842fa7, 0xc6fa81be, 0x66d0fdaf, 0x1a21383c, 0x35e51521, 0x4a9e4c7b, 0xf9230d9a,
  0x3f4bdb62, 0xd8ac2512, 0x18b466e8, 0x36f62425, 0x1f7342bb, 0x8d3ba2f9, 0xd5636707, 0xdaec554c,
  0x5a48c8de, 0x5b6d8fe3, 0x06aaf438, 0xe1cb084a, 0x082b9eff, 0x055d4283, 0x13f64c67, 0xd69a1f23,
  0x2d476247, 0x73c08da4, 0x7980c0e5, 0x9052fc7d, 0x7982cc40, 0xf29294da, 0x92628c3b, 0x86e484b2,
  0x917c9290, 0xd147eb9a, 0x0ce4fef4, 0x2af0ecb3, 0xaf26cbd8, 0x5af3a46a, 0x0d745dc5, 0x1d058ae6,
  0x66eb63ab, 0x15c940cb, 0xac64ba6c, 0x4eecff09, 0xcc841ecb, 0x600a216d, 0xe57974b9, 0xc9a93a40,
  0x22f1aec8, 0xb673bb50, 0x784da591, 0xd503ffe9, 0xc122782c, 0x566cde90, 0x4afe29d4, 0x8107d17b,
  0xb6bb1fba, 0xe7be5f05, 0x4a2a654a, 0x83ca541a, 0xcaf306fb, 0xe96241aa, 0xa8dc20a5, 0x860ad3b4,
  0x71dbf2b4, 0x09b802b5, 0x7164665b, 0x0e03e82f, 0xe425c096, 0x6cb6801d, 0xc205f2c9, 0x34d12e03,
  0x3003bd8f, 0xfa116bff, 0x00c8f33b, 0xcbee8c77, 0x9983996c, 0xdaa589e7, 0x2b605e69, 0x5419cee3,
  0x08d01547, 0x452be9ea, 0x476c1039, 0x48911fa7, 0x6c6c8bdc, 0xa5662e68, 0x39006013, 0x0a25fa95,
  0x809e43b1, 0x82b13790, 0x7204bb53, 0x398d3e34, 0x5f61ebb6, 0x7afaf836, 0x212121f6, 0xa47f91bc,
  0x85a68c16, 0x8e06e4dd, 0xfec998aa, 0x22488008, 0x56019b57, 0x8f1a8a9d, 0x2e1425a5, 0x158cbde2,
  0x39082152, 0x441014ec, 0x48cdebf8, 0x5b086560, 0x846b4515, 0xb42f24d2, 0xa0fe94ae, 0x2327d006,
  0x44dae2ca, 0xc26441d2, 0xd63dc240, 0x2374ddb6, 0x750626e8, 0xf729b7e2, 0xa7bd9405, 0xfa606c2b
  },{
  0x9687538c, 0xf1006862, 0xecb1f913, 0x6e4c682a, 0x833d3446, 0x806080fc, 0x6272c251, 0xd67fd771,
  0x1e181717, 0xd55ae12b, 0x792bdfe5, 0xeeee4fd8, 0x78b5d940, 0x73e080cc, 0xf1be1a1d, 0x44b3de73,
  0x251cf094, 0x46916dd9, 0x3a052282, 0x35cc1abf, 0xf2c5585b, 0x996125c3, 0x7fda4d9f, 0xe522de5d,
  0x98a021a3, 0xafb4aae7, 0xd3935d93, 0x7b50bf22, 0x5efd6440, 0xb3258703, 0x0ce0c22b, 0x52b9fb08,
  0x2accfb8a, 0xed0cbbd0, 0xb4b7d353, 0xcd6094fc, 0x00cb4328, 0x2ce32587, 0xcb7d16da, 0x83ffff6b,
  0x4e06335c, 0x9b8953b2, 0x01078280, 0xbc64f954, 0x90f1b7cf, 0x757c1630, 0xd802be6c, 0x72b2b34c,
  0x1923de2e, 0x0cd0fdb2, 0x23de2e97, 0x600e51f6, 0xf2807229, 0x525b1678, 0xed9a902a, 0x3d943746,
  0xf990ed32, 0x6b105fc1, 0x30b9d2d2, 0x87568fb7, 0x2047286f, 0x0c7ecdfc, 0xda99ecb0, 0x7c777ddd,
  0x8ec77b3a, 0xdcfd55b3, 0x6d67f3a4, 0xcef9fc9e, 0x30be0ae5, 0x8ece1942, 0x35643d13, 0x5897493e,
  0x8c4a51b7, 0x53bf9198, 0x04e84d4c, 0x4dfaa87b, 0x45295f0b, 0xeeeb84da, 0x63dbf3dc, 0x1d652ef4,
  0xf3caf35a, 0x6a394030, 0x8a1d5cf0, 0xb8ac6b89, 0x1ae8dfb6, 0x449c486f, 0xbcd6f72c, 0xef1d1b1e,
  0x6cc2a10e, 0xb2d16ab1, 0x3c1bf4fa, 0xd99d884f, 0x1ddd211a, 0x6e88565c, 0x3336fc75, 0x24ba43ad,
  0xcbf1a1c2, 0x282d0278, 0xa248a3b0, 0xbba17d45, 0xbcb439f2, 0xa525ce92, 0x963db371, 0xee92d526,
  0xbde437ef, 0x1dbedb37, 0x4a2c5fd8, 0xa8262d76, 0x312dbfbe, 0xf7fe2ffa, 0x29e0af25, 0xa805f1b3,
  0x3b2c3a13, 0x641148c5, 0xaa56cd7f, 0x912546c4, 0xae81ec09, 0xc670f9c7, 0x45728689, 0x81ba5b27,
  0xde9501ac, 0x09ebe6f0, 0x9aed9b6e, 0xa94843e9, 0x7f01c888, 0xcc5e904a, 0x9492bf1d, 0x139de440,
  0x3d1fa114, 0x1c198bde, 0xae4bb6b4, 0xe49912e9, 0xed178037, 0x88cb52b2, 0x28465aa4, 0xf09e4d1a,
  0x1ea8f801, 0xceda94b3, 0x06310a04, 0x17af3649, 0xee88d933, 0x6f635536, 0xc153acf0, 0xc6f5b4c6,
  0x1b79253b, 0xb852b7a3, 0xa5221d2b, 0xe768a7e3, 0x7fb02146, 0x92188c3f, 0x0649b6d1, 0x3decb159,
  0x459c2630, 0x6fc389e4, 0x22b608a7, 0x6853f29d, 0x14254b0b, 0xb943451b, 0x9a8a089f, 0x2830f27f,
  0x36492a70, 0x2043d7dd, 0xfeee0933, 0x55e53c35, 0xf89f7d6f, 0x55c0f3aa, 0x9e7e16e9, 0x1a03afdc,
  0x0fc835ab, 0xc24c6f5f, 0x1681d34c, 0x7db4893a, 0x63cd468e, 0xc9f365ea, 0xecedcfe8, 0x7a67c9dd,
  0x5ea48fc9, 0xfbf715b8, 0x69e13c10, 0xe86d9dcc, 0x510e8956, 0xd99f1c5a, 0x555ecc75, 0x70da53b4,
  0xe65346d0, 0x7e966d87, 0xb74be4ea, 0xfeb2def2, 0xe014a667, 0xd9d3ccf2, 0x0b1b3c6c, 0xcc854d00,
  0xc6a985a6, 0x5e00e13d, 0x67f2a3f2, 0xea012897, 0xd5be0a49, 0x1fac0cde, 0x18baf40c, 0x32f22fac,
  0xacb3c4f5, 0xe76456df, 0xda33e92c, 0x0bc0683c, 0xb1aafe55, 0xd4f0384b, 0x15569e66, 0x5627f1e5,
  0x5dd98a24, 0x07f3b02a, 0xb0fc2952, 0x16603d49, 0x7f385db6, 0xf906865c, 0xa6fff84a, 0x9b38f74c,
  0xee30e947, 0x5a004c40, 0xf0c002b8, 0x45886393, 0x4697fd6e, 0x46eee102, 0xf3164199, 0x8079ee05,
  0x936c8c41, 0xdf00a169, 0x751370c5, 0xd97f5aab, 0x098651a6, 0x7d78b38b, 0xe65988b1, 0xde165d97,
  0x29fcfc2e, 0x79e21036, 0x5aba4d06, 0xe07c4ee8, 0x90ab2abb, 0x3921ca3f, 0xf85f5217, 0x99ad2268,
  0xa11fe9b1, 0x6bb22233, 0xb0e7baa6, 0x86f58bf0, 0xea38da77, 0x1523c36d, 0xf89fdf03, 0xe734888f,
  0x1010722c, 0x9dabc717, 0x764486b2, 0x63ecc00f, 0xfb0e32d2, 0x6e6d4cf5, 0x09ed6a6c, 0xfe89f4b5
  },{
  0xecbcd0ff, 0x9dc05776, 0x2b845fe1, 0x3c29a64b, 0x4eb9038d, 0xd313c076, 0x57fba9dc, 0x112506e7,
  0xb48b8383, 0xfc25b4af, 0x0737e954, 0xa285bc5b, 0x1c1c43e3, 0xf02d9be2, 0x556db535, 0x8f9d9f4e,
  0x0a8e4154, 0xbed0d8d2, 0xf754956b, 0x234fb407, 0x84952ff5, 0xf80dfc4d, 0x10abc1d4, 0x5951c885,
  0xeab2cfe8, 0xae17bac1, 0xe580f8eb, 0x92568279, 0x81cfed5c, 0x906b2dac, 0x59a89239, 0xfa003ded,
  0xde4cc087, 0x888cda03, 0xda6743ef, 0xa88f4ab2, 0xb12371f3, 0x33443733, 0xd0b79f2d, 0x5967254e,
  0x77e41e68, 0xf6acdd24, 0x0891cfa9, 0x1968713b, 0x71511e44, 0x5adbe550, 0x8135275a, 0x3e51af88,
  0x2247643f, 0x6022ede0, 0xec637c2a, 0xc495b633, 0x4b7e2d35, 0xfb465fac, 0x12dfa27f, 0x23a90f72,
  0x94e95005, 0xc6ba9ca1, 0x405c78b8, 0x4dbcf569, 0x3031f59c, 0x60e634a0, 0xdbcff059, 0x262c3747,
  0x47e04e2d, 0x76451cef, 0x7fafa44a, 0xb70d904b, 0xd1c5248e, 0x0e0c607f, 0xa45ecaac, 0xad3a7bdc,
  0xdcdc613f, 0xe829a983, 0xff9b67a7, 0x649f7529, 0x2d65fd4c, 0x3ae389c5, 0x2ffd0cc4, 0xbe9b4d3f,
  0x0042f65e, 0x05c32588, 0xcba9f9e1, 0x8432f461, 0x43405800, 0x3f06cd43, 0x202a04a5, 0xbc425d43,
  0x9132a46e, 0x983b95ef, 0x714a64eb, 0xdc71028b, 0x80f516d8, 0x1f695f63, 0x43c4cb06, 0x4a80c914,
  0x13f345d3, 0x0d12aba0, 0xbc133bab, 0x00f1ef15, 0xe57959a1, 0x34f5dae8, 0x6787270e, 0x068f7ca3,
  0xa0278fe8, 0x86778920, 0x3e5f10c4, 0x9e6d5685, 0x6a3a8de2, 0xe68e50f1, 0x7e575e6c, 0xe8b658ac,
  0xed7b4de2, 0x78a5bf01, 0xe6f339bb, 0xce984683, 0xc6427624, 0xf5d6c8e9, 0x015501b6, 0xbe1d43f5,
  0x0b0b5ec6, 0x7a16e223, 0xb4539fab, 0x97cfc565, 0x2d7a44d3, 0x3c2c6b0c, 0xbfa82bfb, 0x9847ec83,
  0x194c6f09, 0xcf43b52b, 0xd15f35be, 0x13f8c942, 0x74ed38f6, 0x1b71a276, 0x25a6a229, 0x836996ad,
  0xc667f44d, 0x1934d553, 0x5fed01c9, 0xef665d3b, 0x362f0b76, 0x81442b66, 0x499bd017, 0xac1b13c9,
  0xb6901631, 0x0c29fc66, 0x4ad97f81, 0x136c89b3, 0xb9599eab, 0x84232619, 0xe380ee02, 0xb566c590,
  0x88c6d146, 0x47d9f1a2, 0x4634dd60, 0xd3e40e17, 0x7c3ab4f5, 0xbfffb9f8, 0xa9bc4aa0, 0x8a959ffe,
  0xf82b3c92, 0x9daf247f, 0x559b3960, 0xcb9b8b9b, 0x581815dd, 0x1a9a2048, 0x8e634182, 0x11b9d4a4,
  0x9c6eb3c7, 0xc346d3d1, 0xffb6707a, 0x6c023e9c, 0xcb369159, 0xfa40e84d, 0x9f0f53a1, 0xeaec7062,
  0x000c8ca5, 0x40c608a5, 0x7e696231, 0xec88d92d, 0x17c0e252, 0xf5bde19e, 0xd4523fe7, 0x68a24bcf,
  0x2825dc0d, 0x68ffffc2, 0x8b2be390, 0xe0a87889, 0x749f1ad0, 0xbeddeafd, 0xf43aab6b, 0x3066f9a2,
  0x60ad032d, 0x5922814b, 0xf57508e4, 0x4ec560b5, 0x24ddd557, 0xbaf88455, 0x4d25210f, 0xa9ea1114,
  0x8b551c79, 0xa9226c6a, 0x56f89e79, 0xd157241f, 0x6605ebfb, 0x7ceaeeb7, 0xf1aa054e, 0x58d2a4b4,
  0x782b2f37, 0xe15ea5c8, 0x8ed41834, 0x8e2a87e4, 0x872f39e6, 0xe5fa9659, 0xf02737e5, 0xdaccbf01,
  0x36aebeef, 0x3e668817, 0x0b4c0e3b, 0x3359a026, 0xe9be9f39, 0x3d027645, 0xd7295771, 0x4584b470,
  0x502f4398, 0x4c05d329, 0xe5ec7ac9, 0x82af4273, 0xa422f526, 0x8b510cfa, 0xb56583b8, 0x16f52d17,
  0x5168a8b7, 0x0754d9d5, 0x79431dd1, 0xc1240f6a, 0x8de3276e, 0x8a44025e, 0x06ef6bf6, 0x3fcf785c,
  0x7a51dc36, 0xfb37c474, 0xb3d82c81, 0x4841961f, 0x1f8d3d7f, 0x970205f7, 0x1322c4ee, 0xb3ed30dd,
  0xfc451727, 0xb9e59ab0, 0x2f2bf1f3, 0xc40e8866, 0x516e35f2, 0xd5e27aa9, 0xc1d3ea01, 0xbfe7cc1a
  },{
  0x47623004, 0x743e1079, 0xbd1045fd, 0xa9918225, 0xa62b7b6a, 0x5147dc70, 0x707ef1e1, 0x65725ba8,
  0x28ac77b4, 0x305c7a04, 0x79accbb6, 0x17b55bfb, 0x1b45c89e, 0xd07ec846, 0xa7b5f0be, 0x1a97c941,
  0x74380ad2, 0x699aaa11, 0x0513be20, 0x98d6f926, 0xde213d72, 0x8e84a572, 0x14f2db9e, 0xc74dcd0b,
  0x790a61fc, 0x97198242, 0xbc0206fe, 0x9ea1ec32, 0x8e3573f0, 0x9058f226, 0xf193978d, 0xe9e21ab8,
  0x396f97d8, 0x8c15a028, 0x490a4900, 0xabc32c90, 0xa001c50c, 0xd200a3ac, 0x18796545, 0x2843b9bc,
  0x00dd51ba, 0x85aa88a4, 0xc9681f3e, 0xaf67887c, 0x5ed88c9d, 0x5cf39b4d, 0xddd79935, 0x20146059,
  0xaca59f79, 0x2410e285, 0x86ed22a5, 0xd4b8fc26, 0x6d198da9, 0xe912b7ba, 0xde3b62ee, 0xdf9ab16f,
  0x36003a12, 0x99bc6ade, 0xaaf592a9, 0xc10266ed, 0xf0a01e0d, 0xbeaf7717, 0x33f42bf9, 0xbfa1e45a,
  0x8c6ee4d3, 0xb0f307d9, 0x6fa51ad3, 0x7758e3aa, 0x70aa9340, 0xe76e380e, 0x6057b486, 0x61d69b84,
  0x795fb7af, 0x2f1d46da, 0x8a9eff39, 0xfed67df6, 0xf02e15f2, 0xe462835d, 0x43f0c0f9, 0xcd1312b9,
  0x3919f3f2, 0x935bae9a, 0x8c174b08, 0x81363c91, 0x76502002, 0x67ea2f1e, 0xcfd3769c, 0x087f909c,
  0xde45ce10, 0x5371ef4c, 0x9d0cf6f9, 0x8e5525e1, 0x31233a06, 0xcfb00512, 0x127c8555, 0x56fa1254,
  0xd3621873, 0x1ec73ede, 0x78e4f3d9, 0x1adb30dc, 0x1beb57ea, 0x83f55739, 0x417b3bcc, 0x71928ec6,
  0x9c98306e, 0x252aaaee, 0x00dd375a, 0xccc0cd64, 0x8054e3b2, 0x6cd4db51, 0x94485bdf, 0xe5247047,
  0x4d852cac, 0x507f75ee, 0x95fdf9fe, 0x2b0aa143, 0xf7d17221, 0x07daea48, 0xb5f0e8ef, 0x104d169c,
  0x686d510a, 0x76e24612, 0x21e1aa01, 0xb41d9d92, 0xe91ea4c2, 0x490d62f2, 0xef8cf929, 0xe6b5e197,
  0xe5458c0e, 0xc8d8332f, 0xba6325ea, 0x4b651f33, 0x640f9291, 0x7f879891, 0xb431ae28, 0xc0742760,
  0xfeb3a61f, 0x7ec0e73c, 0xb95ea022, 0x43dc3618, 0x8610eb7c, 0x11df8c2f, 0x31287b97, 0xc4ea8adb,
  0xce048ad9, 0x7d3fd18d, 0x39c3e0bf, 0x30b20997, 0x798bb8e8, 0xe2b4d5b3, 0x46f62900, 0x9b7ba335,
  0x0cddefa5, 0xdbb6fdd3, 0x7d6e4086, 0x96904f1e, 0x3bf6c5b0, 0x8d86ad1e, 0x4de334d0, 0x1d6e34cd,
  0xe7d85e9c, 0x164933fd, 0xf7e5d409, 0xd5f94533, 0xb4b2cadc, 0xa4c244b1, 0x7e993ff6, 0x5a3d8947,
  0x97c98091, 0x74b95060, 0x5b719b28, 0x2da6ce03, 0x08be365e, 0x8ba46945, 0x12eb5614, 0xeb17eedd,
  0xb0e42acf, 0x3b590702, 0x52512142, 0xfba8ded3, 0x55617542, 0x9a80db81, 0x58ba4f44, 0x94bc591c,
  0xdd4d1482, 0x182e45ff, 0x97625a76, 0xc576e141, 0x2b508dd3, 0x7fd214a3, 0x74f51f30, 0x0a8aa754,
  0x4bc51ba7, 0x9fc65233, 0x60230e3c, 0x277c11ef, 0x999f9da5, 0x2faeb376, 0xea7d614b, 0x71af5d16,
  0x0b42ce88, 0xf6cd9727, 0x13407daa, 0x9676fc0d, 0x28306dcb, 0xd37853e9, 0x6ed1d06f, 0xf6312328,
  0xc246a1dc, 0x85c46636, 0xe754594a, 0x7a309694, 0xd4743ec9, 0x83705219, 0x1e46071f, 0x23a64ea5,
  0x49789b7d, 0xa068f879, 0xe94067f2, 0x63c7e29b, 0x7fb6a5e4, 0x6e5de48a, 0x3c889e63, 0x50a80024,
  0x4f635c09, 0x6da88c3b, 0xf119e258, 0x2ffa0b79, 0x444c2eca, 0x356b3742, 0xae419c59, 0xfc2d22a3,
  0xafdcebbd, 0x643a7d7c, 0x3ce196f9, 0x46520944, 0x1b7a1a40, 0x231a157f, 0x583a884c, 0x1568bc25,
  0x4c31d47f, 0xe4b172ac, 0x7bbaec25, 0x0ba252c7, 0xddf34fc3, 0x0b802ed3, 0xc9c6e4e3, 0xe41fd6ed,
  0xa9461277, 0xa0e2aed3, 0x414a3bfc, 0x7ee3fd00, 0xf5e2947d, 0xdc479d6f, 0xf3ef3f0c, 0x1204fe96
  }
};


FILE*         SubkeyFile;



unsigned int rsa[] = {
  0x31, 0x92, 0x4b, 0xe3, 0xf4, 0x16, 0x60, 0xf5,
  0xa9, 0xad, 0x86, 0x7c, 0xa1, 0x0c, 0x41, 0x86,
  0xc1, 0xbe, 0xcb, 0x70, 0x62, 0x3c, 0x3d, 0xbc,
  0x68, 0xeb, 0xb6, 0xbb, 0xc6, 0x21, 0x87, 0xf8,
  0xd2, 0xa9, 0x09, 0x90, 0x01, 0x9c, 0x4b, 0x29,
  0x58, 0x04, 0x64, 0xb5, 0xd4, 0x4b, 0x92, 0x9c,
  0x2d, 0x90, 0xd7, 0xda, 0x9d, 0xa2, 0x62, 0xb9,
  0x17, 0x0b, 0x7f, 0x59, 0x03, 0xc5, 0x2b, 0x47,
  0xc6, 0x15, 0x7b, 0xf2, 0xb6, 0x45, 0x1b, 0x50,
  0x4f, 0x8b, 0x4e, 0x33, 0xe2, 0x7f, 0xd5, 0x20,
  0xa3, 0x0b, 0xd4, 0x4e, 0x37, 0x8a, 0xbf, 0xf3,
  0x07, 0x75, 0x40, 0x9e, 0xc7, 0x8c, 0xaa, 0x81,
  0xa8, 0x5d, 0x14, 0x4c, 0xdb, 0x2d, 0x1e, 0x4b,
  0x7c, 0xbb, 0x7f, 0xc3, 0x57, 0x3f, 0x87, 0x91,
  0x2e, 0x38, 0x87, 0x60, 0x5c, 0x50, 0x51, 0xb7,
  0x64, 0x8c, 0x18, 0xcc, 0x5d, 0x97, 0xc4, 0x66,
  0x17, 0xb3, 0x39, 0xba, 0x9c, 0x6a, 0x53, 0x07,
  0x2c, 0x95, 0xf7, 0x43, 0xf0, 0x78, 0x8e, 0xa3,
  0xb0, 0x38, 0x17, 0xe2, 0x47, 0x45, 0x34, 0x4f,
  0xe7, 0x2a, 0x15, 0x89, 0xe9, 0xd8, 0x79, 0xd0,
  0x9f, 0xa3, 0x96, 0x0a, 0x25, 0x25, 0xd7, 0x60,
  0xda, 0x9b, 0xa5, 0xaa, 0xa8, 0xe9, 0x34, 0x6f,
  0xc7, 0xff, 0x3f, 0x68, 0xba, 0x12, 0xc7, 0xd5,
  0x79, 0xf9, 0xf1, 0xd6, 0xa1, 0xff, 0xe2, 0x67,
  0x2c, 0x69, 0xbf, 0x12, 0xfa, 0xad, 0xed, 0xd9,
  0x52, 0xfd, 0xe5, 0xe4, 0x1c, 0x07, 0x90, 0x9c,
  0x87, 0x52, 0xdb, 0x48, 0xe3, 0xdc, 0x63, 0x7e,
  0xe7, 0x33, 0xe7, 0x78, 0x4b, 0x07, 0x2b, 0x52,
  0x9f, 0xc8, 0xd8, 0x9c, 0x9f, 0x02, 0x90, 0x2d,
  0x9f, 0x74, 0x44, 0x95, 0xae, 0x88, 0x98, 0x66,
  0xb3, 0x2b, 0x2e, 0x4d, 0x79, 0xa4, 0x16, 0x5f,
  0x24, 0x55, 0xcf, 0x9c, 0xb5, 0xc7, 0xae, 0xfb
};

int g_init;

unsigned int F(unsigned int x)
{
  unsigned short a;
  unsigned short b;
  unsigned short c;
  unsigned short d;
  unsigned int  y;

  d = (unsigned short)(x & 0x00FF);
  x >>= 8;
  c = (unsigned short)(x & 0x00FF);
  x >>= 8;
  b = (unsigned short)(x & 0x00FF);
  x >>= 8;
  a = (unsigned short)(x & 0x00FF);
  y = S[0][a] + S[1][b];
  y = y ^ S[2][c];
  y = y + S[3][d];

  return y;
}

#ifdef BUILDTOOLS
void rsa_encypher(unsigned int *xl, unsigned int *xr)
{
  unsigned short a;
  unsigned short b;
  unsigned short c;
  unsigned short d;
  unsigned int  x;
  unsigned int  y;

  unsigned int  Xl;
  unsigned int  Xr;
  unsigned int  temp;
  short          i;

  Xl = *xl;
  Xr = *xr;

  for (i = 0; i < N; ++i) {
    Xl = Xl ^ P[i];

    x=Xl;
    d = (unsigned short)(x & 0x00FF);
    x >>= 8;
    c = (unsigned short)(x & 0x00FF);
    x >>= 8;
    b = (unsigned short)(x & 0x00FF);
    x >>= 8;
    a = (unsigned short)(x & 0x00FF);
    y = S[0][a] + S[1][b];
    y = y ^ S[2][c];
    y = y + S[3][d];

    Xr = y ^ Xr;

    temp = Xl;
    Xl = Xr;
    Xr = temp;
  }

  temp = Xl;
  Xl = Xr;
  Xr = temp;

  Xr = Xr ^ P[N];
  Xl = Xl ^ P[N + 1];

  *xl = Xl;
  *xr = Xr;
}
#endif

void rsa_decypher(unsigned int *xl, unsigned int *xr)
{
  unsigned short a;
  unsigned short b;
  unsigned short c;
  unsigned short d;
  unsigned int  x;
  unsigned int  y;

  unsigned int  Xl;
  unsigned int  Xr;
  unsigned int  temp;
  short          i;

  Xl = *xl;
  Xr = *xr;

  for (i = N + 1; i > 1; --i) {
    Xl = Xl ^ P[i];


    x=Xl;
    d = (unsigned short)(x & 0x00FF);
    x >>= 8;
    c = (unsigned short)(x & 0x00FF);
    x >>= 8;
    b = (unsigned short)(x & 0x00FF);
    x >>= 8;
    a = (unsigned short)(x & 0x00FF);
    y = S[0][a] + S[1][b];
    y = y ^ S[2][c];
    y = y + S[3][d];

    Xr = y ^ Xr;

    /* Exchange Xl and Xr */
    temp = Xl;
    Xl = Xr;
    Xr = temp;
  }

  /* Exchange Xl and Xr */
  temp = Xl;
  Xl = Xr;
  Xr = temp;

  Xr = Xr ^ P[1];
  Xl = Xl ^ P[0];

  *xl = Xl;
  *xr = Xr;
}

#ifdef BUILDTOOLS_UNUSED
short rsa_initialize(void)
{
  short          i;
  short          j;
  short          k;
  short          error=0;
  unsigned int  data;
  unsigned int  datal;
  unsigned int  datar;
  short           keybytes=256;

  if(1!=g_init) {
    g_init=1;
    j = 0;
    for (i = 0; i < N + 2; ++i) {
      data = 0x00000000;
      for (k = 0; k < 4; ++k) {
        data = (data << 8) | rsa[j];
        j = j + 1;
        if (j >= keybytes) {
          j = 0;
        }
      }
      P[i] = P[i] ^ data;
    }

    datal = 0x00000000;
    datar = 0x00000000;

    for (i = 0; i < N + 2; i += 2) {
      rsa_encypher(&datal, &datar);

      P[i] = datal;
      P[i + 1] = datar;
    }

    for (i = 0; i < 4; ++i) {
      for (j = 0; j < 256; j += 2) {

        rsa_encypher(&datal, &datar);

        S[i][j] = datal;
        S[i][j + 1] = datar;
      }
    }
  }

  printf("unsigned int P[N + 2] = {\n");
  for(i=1; i<=N+2; i++) {
    printf("0x%.8x, ", (unsigned int)P[i-1]);
    if(0 == i % 9) {
      printf("\n  ");
    }
  }
  printf("\n};\n\n");

  printf("unsigned int S[4][256] = {\n");
  for (i = 0; i < 4; ++i) {
    printf("\n{\n  ");
    for (j = 1; j <= 256; j++) {
      printf("0x%.8x, ", (unsigned int)S[i][j-1]);
      if(0 == j % 8) {
        printf("\n  ");
      }
    }
    printf("\n},\n");
  }
  printf("\n};\n\n");

  return error;
}
#endif
